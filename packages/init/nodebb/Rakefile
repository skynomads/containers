require 'dry-configurable'
require 'pp'
require 'common'

extend Dry::Configurable

# https://github.com/NodeBB/NodeBB/blob/fe0020fb31e64a5cd9ccd8039786fdd248a32106/src/install.js#L52

task default: %i[init start]

task :init do
  Dir.chdir('/usr/share/nodebb') do
    sh './nodebb setup'
  end
end

task :start do
  Dir.chdir('/usr/share/nodebb') do
    exec('node', '/usr/share/nodebb/nodebb', 'start')
  end
end

task :debug do
  pp config.to_h
end
